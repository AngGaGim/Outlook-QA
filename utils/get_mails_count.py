import requests


'''
获取邮件数量
'''

def get_mails_count(token,skip):
    total_count = skip
    headers = {"Authorization": f"Bearer {token}"}
    url = f"https://graph.microsoft.com/v1.0/me/messages?%24count=true&%24top=10&%24skip={skip}"

    while url:
        response = requests.get(url, headers=headers)
        data = response.json()
        count = len(data.get("value", []))
        url = data.get("@odata.nextLink")  # 处理分页
        print(url)
        total_count += count
    print(f"总邮件数: {total_count}")

if __name__ == '__main__':

    # 电商账号
    token = 'eyJ0eXAiOiJKV1QiLCJub25jZSI6Ik0xQl9hdEQ0Y05nVVVSbUprWFBaM1VuR1FjWTNXbUZiVXR2OE5vOHB4MjgiLCJhbGciOiJSUzI1NiIsIng1dCI6ImltaTBZMnowZFlLeEJ0dEFxS19UdDVoWUJUayIsImtpZCI6ImltaTBZMnowZFlLeEJ0dEFxS19UdDVoWUJUayJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9mZDliMTY4NC0xNTFjLTQwMGYtOWI4Ni04ZWI0NjhlMGUyMzQvIiwiaWF0IjoxNzQwNzMzODE1LCJuYmYiOjE3NDA3MzM4MTUsImV4cCI6MTc0MDgyMDUxNSwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6ImsyUmdZSkMwVTR1OXZWZFdQU216cTIzYi80eGVSMlYzdmZMbXZQZkNUcElHV3RWTGwvc0d6ZGhUTnZIbDhiYlVDem12UFp3ekFBPT0iLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IkdyYXBoIEV4cGxvcmVyIiwiYXBwaWQiOiJkZThiYzhiNS1kOWY5LTQ4YjEtYThhZC1iNzQ4ZGE3MjUwNjQiLCJhcHBpZGFjciI6IjAiLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIxODUuMjIwLjIzOC4xOTQiLCJuYW1lIjoiRmFmcmVlcyBFYmlrZSIsIm9pZCI6IjRlMmEwOTI5LTM3NjktNDg0OS04NDVlLWRmNGY3ZDQ3MzdlYSIsInBsYXRmIjoiNSIsInB1aWQiOiIxMDAzMjAwMjQ1OEI0OEY0IiwicmgiOiIxLkFYRUFoQmFiX1J3VkQwQ2JobzYwYU9EaU5BTUFBQUFBQUFBQXdBQUFBQUFBQUFDSEFKRnhBQS4iLCJzY3AiOiJvcGVuaWQgcHJvZmlsZSBVc2VyLlJlYWQgZW1haWwgTWFpbC5SZWFkV3JpdGUiLCJzaWQiOiIwMDIyZDIyOS0yY2I1LWU2NDAtZGRhYy1hYmE4MmUyN2NmMjUiLCJzdWIiOiJKU2FPREV5RzgySm5BWThnYkZfZHJNNW9qd21NTVlUN0VJbU9HazZoQl9BIiwidGVuYW50X3JlZ2lvbl9zY29wZSI6IkFTIiwidGlkIjoiZmQ5YjE2ODQtMTUxYy00MDBmLTliODYtOGViNDY4ZTBlMjM0IiwidW5pcXVlX25hbWUiOiJmYWZyZWVzQGZhZnJlZXNlYmlrZS5jb20iLCJ1cG4iOiJmYWZyZWVzQGZhZnJlZXNlYmlrZS5jb20iLCJ1dGkiOiI2Q2xiRDV5Q2gwV21YVndqRlVxc0FBIiwidmVyIjoiMS4wIiwid2lkcyI6WyJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2NjIjpbIkNQMSJdLCJ4bXNfZnRkIjoiT2xCTWZVVk1iTGJpVDBaMkNueF93dW9KWWQyM2M5WVZCTEJqR2ZsZVJIMCIsInhtc19pZHJlbCI6IjIyIDEiLCJ4bXNfc3NtIjoiMSIsInhtc19zdCI6eyJzdWIiOiIwa3BRRVNHM0JkdElsWHdtc1JCcFFjaFRSdVR2a3JMbmhEWm1VbHU4cVhrIn0sInhtc190Y2R0IjoxNjU3MDgyNzUyfQ.ViEav1C9BDkGjkHXXU8e5hpiv9TTEqAInylmUNOyBYMYOexQZlZxdQyddBGfaSsptSznB3OhkD2WwSuHJFNPlwzmrYRKU1w4QwkpIoXLG0iQoQYjmFuaOeABuqzVS6OkUMc6ydMbH9No0U-AWrcvC0ZVu3zH25RleKeZIM8Zhh5BRW66CnwKk8WL8ImmlKF4TY80eV0zMeJrWmbAjqxajyjZ_XEcfbEtH1UAs7f-HH3d97KGL5t4MSxuxajGUUx3oaucS4_V2CgZq2P847i5oO6eRQ9Lj3iW6E1ik-QcR8nrK7hKRUCSNsl-FV-xsuOWjUK11-3C9Av2yCVBCAi6Aw'
    # 个人测试账号
    token = 'EwA4BMl6BAAUBKgm8k1UswUNwklmy2v7U/S+1fEAAcd34txEourTijHbc7rIUY7+7iJea3aqY+q9LGycOku2Cdy5Zi9pbcxCjm/tzGtF6R9WS6Vky4f2O8noQDEi3U9fBpGm1tsw7106LzLY6cuOrdwYZMnBb0WWFA+Ax1YfB2rGU7mx0VnIq14TpOVT3CUoxFXFRSbL2zbTbAyptRI1W0tuvtjk1vVj3TdlXBKMvsTFfJhjY4hVakMsBO1t3iPGjdbMExSuwBLjjpdgXKE1MaFkappssEGZzXN8qi4Lb8vawPAyCWnaA7aMCF4bLgNJr66+KNy3RRt18qMSMhu4NS1u5ETwqcEGY5PqD7ORkcEz5w0dYxkG+iW/iCSWhK8QZgAAEL1Qy3XnTBl2I8IvXEXdx18AA6+CW1ned0Zgt3VIGTCQ035gctmp+d27IT4YlP7lPRV3ROrLfwxmQ/gJUANR+snjTKtnd7mph5ePizLKN93roJ7FBxWxDB+EawUwydE0TLXKe+0Vnjy1kRgDOuAcRWDPwcVOsflX0PxXhJVFsGN/kt5Yq4VIB/0ThUmG9WDt4/S/oHU0AVJUAa954VSzU+wATls+YqyZy+zfqYmE/NgkfsSFj2wxyW9d8bhJTccL5z+7XVKU8Rg1AkdOMN3TwmC/EyB3bpOiuSPHjXAYduDXccdQldk4wlRYGB5Toqwj6oVtDF24o1CzrsR/Oh30i84dI8aGQ0sQfjsdta6/+RhhWIPQaunDO1r4ZIaAXms/zqnLApnttSf7WKOUc9QfsUr4iYBanpA/n2OefdNRdejQ/AxUkmmbuJ47a55reDDO3Jxf+JC97qBEEfUAOf9j3tnpNQj2y4JiGu/3L4mXRoD0ZI00YxCUfRpVbwso45XPEy2DXkeHaXRtwOoUrikeUIR/gNMTkIZyl3fEEjWt98nqwE4/JkVPrqdhFLp40xiWBtJoI4yQFX+4sBPEApn4LXSrb8u72ylpmCwzUWE/BHMLcAq73uj8gNdWHOlPiDCalVSzdKfyCgjkFsZNKvTb7Y9ieHY5LV+itcf7Txs36hpx52iWd9BA35LF48GopIvx4rBwLBBva7hrF0Xyx2bDpsVlfTZvCTKnJ6OVhrZNU42rK2IYi4H3+zgOTw7ipCJStFfBrwcIepNwpnrH6z8WuYl1JScLD9t4we+PnHidXkbLVq8g2zzrJsg6qzwP84M0oBCgk4QPpKvMfGUeistk5gpl79xVOo9V1szWT3VvOkRs74IfdIu5PosbkBXkLTNpMAr+XULqBDVjm6xQfo5rqjBe0aZaYJRkmWub5QHcv0OXSgp0YTZ/f7Sfgx1c3OZCK+wYxRUkh4ZtTQ73Vxtx+cgPziOjIi/oQA//3zVSCfefuP3wLM0sktoAufVxZQbGOAUgXKjBwU9j2i7IvWXm+kc40kID'
    get_mails_count(token,skip=10)
